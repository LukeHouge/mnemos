FROM python:3.12-slim-bullseye

# Install system dependencies for development
RUN apt-get update && apt-get install -y \
    git \
    curl \
    vim \
    bash-completion \
    procps \
    net-tools \
    libatomic1 \
    build-essential \
    gcc \
    && rm -rf /var/lib/apt/lists/*

# Install uv
COPY --from=ghcr.io/astral-sh/uv:latest /uv /bin/uv

WORKDIR /workspace

# Copy dependency files from backend
COPY backend/pyproject.toml backend/uv.lock* ./backend/

# Install all dependencies (including dev dependencies)
WORKDIR /workspace/backend
RUN uv sync --extra dev

# Set working directory back to workspace root
WORKDIR /workspace

# Default command - just keep container running
CMD ["tail", "-f", "/dev/null"]
